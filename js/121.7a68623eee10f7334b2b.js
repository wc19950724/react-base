"use strict";(self.webpackChunkreact_base=self.webpackChunkreact_base||[]).push([[121],{3121:(e,t,i)=>{i.r(t),i.d(t,{default:()=>b});var s=i(1527),n=i(2389),r=i(9916),o=i(4875),h=i.n(o),a=i(4727),d=i(959),l=i(7327),c=i(7217),u=i(8788);const m=({model:e})=>(0,s.jsx)(u.Z,{percent:100*e.userData.progress});var p=i(2699),g=i(2625),z=i(3418),w=i(9800);const f=new class{renderer;camera;scene;container;resizeObserver;constructor(){this.renderer=new l.CP7({antialias:!0}),this.camera=new l.cPb,this.scene=new l.xsS,this.container=document.body,this.resizeObserver=new ResizeObserver((0,p.debounce)(this.resize.bind(this)))}initialized=!1;initialize(e){this.initialized=!0;const t=(0,c.sb)(e);t&&(this.container=t),this.resize(),this.container.appendChild(this.renderer.domElement),this.scene.add(this.camera),this.renderer.setAnimationLoop(this.render.bind(this)),this.resizeObserver.observe(this.container)}resize(){const{offsetWidth:e,offsetHeight:t}=this.container;this.renderer.setSize(e,t),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}render(){this.initialized&&(this.controls&&this.controls.update(),this.renderer.render(this.scene,this.camera))}controls;addControl(){return this.controls=new z.z(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this}dispose(){this.initialized=!1,this.container&&this.container.removeChild(this.renderer.domElement),this.resizeObserver.disconnect()}},x=new class{loader;models;constructor(){this.loader=new w.E,this.models={},(0,g.rC)(this,{models:g.LO,updateModels:g.aD})}updateModels(e,t){this.models=Object.assign({},this.models,{[e]:t})}removeModels(e){delete this.models[e]}clearModels(){this.models={}}load(e){if(e?.length)for(let t=0;t<e.length;t++){const i=e[t];if((0,c.tr)(i,"gltf")){const e=crypto.randomUUID(),t={userData:{uuid:e,file:i,progress:0}};this.updateModels(e,t),this.loader.load(URL.createObjectURL(i),(i=>{i.userData=t.userData,this.updateModels(e,i)}),(e=>{t.userData.progress=e.loaded/e.total}))}}}},y=new class{el;#e;#t;#i;#s;#n;#r;#o;get sizeLimit(){return(0,c.nR)(this.el)}constructor(){this.#e="both",this.#t="auto",this.#i={x:0,y:0},this.#r={width:0,height:0},this.#o=()=>{},this.#s=this.#h.bind(this),this.#n=this.#a.bind(this)}initialize(e,t){const i=(0,c.sb)(e);if(!i)throw`${e}: the element is not found`;this.el=i,this.#e=t,this.#o=this.#d()}startResize({x:e,y:t}){this.el&&(this.#t=document.body.style.userSelect,document.body.style.userSelect="none",this.#i={x:e,y:t},this.#r={width:this.el.offsetWidth,height:this.el.offsetHeight},document.addEventListener("touchmove",this.#s),document.addEventListener("touchend",this.#n),document.addEventListener("mousemove",this.#s),document.addEventListener("mouseup",this.#n))}#h(e){requestAnimationFrame((()=>{e instanceof MouseEvent?this.#o({x:e.pageX,y:e.pageY}):this.#o({x:e.touches[0].pageX,y:e.touches[0].pageX})}))}#a(){document.removeEventListener("touchmove",this.#s),document.removeEventListener("touchend",this.#n),document.removeEventListener("mousemove",this.#s),document.removeEventListener("mouseup",this.#n),document.body.style.userSelect=this.#t}#d(){const{min:e,max:t}=this.sizeLimit;switch(this.#e){case"vertical":return i=>{if(!this.el)return;const s=this.#r.height+this.#i.y-i.y,n=(0,c.Ms)(s,e.height,t.height);this.el.style.height=`${n}px`};case"horizontal":return i=>{if(!this.el)return;const s=this.#r.width+this.#i.x-i.x,n=(0,c.Ms)(s,e.width,t.width);this.el.style.width=`${n}px`};case"both":return i=>{if(!this.el)return;const s=this.#r.height+this.#i.y-i.y,n=this.#r.width+this.#i.x-i.x,r=(0,c.Ms)(s,e.height,t.height),o=(0,c.Ms)(n,e.width,t.width);this.el.style.height=`${r}px`,this.el.style.width=`${o}px`}}}},v=(0,a.Pi)((()=>{const e=(0,d.useRef)(null),t=(0,d.useRef)(null),i=(0,d.useMemo)((()=>{const e=[];for(const t in x.models){const i=x.models[t],n={key:t,label:i.userData.file.name,children:(0,s.jsx)(m,{model:i})};e.push(n),i.scene&&f.scene.add(i.scene)}return e}),[x.models]),[o,a]=(0,d.useState)([""]);return(0,d.useEffect)((()=>{if(t.current&&y.initialize(t.current,"horizontal"),e.current){f.camera.position.set(0,10,50),f.initialize(e.current),f.addControl();const t=new l.Mig(16777215,.5);f.scene.add(t);const i=new l.Ox3(16777215,.5);f.scene.add(i);const s=new l._12(100,100),n=new l.xoR,r=new l.Kj0(s,n);return r.rotation.x=-Math.PI/2,f.scene.add(r),()=>{f.dispose()}}}),[]),(0,d.useEffect)((()=>{a(i?.map((e=>e.key||"")))}),[i]),(0,s.jsx)("div",{ref:e,className:"all-full overflow-hidden relative",children:(0,s.jsxs)("div",{ref:t,className:h()("AcDHwprCNla5R0Ld1t5p"),children:[(0,s.jsx)("div",{className:h()("AGEWutM207NeZb5ZeAbq"),onTouchStart:e=>{const t={x:e.touches[0].pageX,y:e.touches[0].pageY};y.startResize(t)},onMouseDown:e=>{const t={x:e.pageX,y:e.pageY};y.startResize(t)}}),(0,s.jsx)("div",{className:h()("P72rzzFosEf1iRBaMVhQ"),children:(0,s.jsx)(n.ZP,{onClick:async()=>{const e=await(0,c.Gx)("multiple",".gltf");x.load(e)},block:!0,children:"加载模型"})}),(0,s.jsx)(r.Z,{className:h()("SmYI8c8DNalNmy5HQJzF"),items:i,ghost:!0,activeKey:o,onChange:e=>{a(e)}})]})})})),b=v},7217:(e,t,i)=>{i.d(t,{Gx:()=>r,Ms:()=>h,XF:()=>s,nR:()=>a,sb:()=>n,tr:()=>o});const s=(e,t)=>Math.floor(Math.random()*(t-e))+e,n=e=>"string"==typeof e?document.querySelector(e):e;function r(e,t=""){return new Promise((i=>{const s=document.createElement("input");s.type="file","directory"===e?s.webkitdirectory=!0:(s.accept=t,s.multiple="multiple"===e),s.onchange=()=>{i(s.files),s.onchange=null};try{s.showPicker()}catch(e){s.click()}}))}const o=(e,t,i)=>new RegExp(`\\.${t}$`,i).test(e.name),h=(e,t=-1/0,i=1/0)=>Math.min(Math.max(e,t),i),a=e=>{const t=n(e);if(!t)return{min:{width:-1/0,height:-1/0},max:{width:1/0,height:1/0}};const i=window.getComputedStyle(t),s=i.getPropertyValue("min-width"),r=i.getPropertyValue("max-width"),o=i.getPropertyValue("min-height"),h=i.getPropertyValue("max-height"),a=(e,s)=>{if(e.includes("%")){if(!t.parentElement)throw`${t}: the parent element of the element is not found`;const i="width"===s?t.parentElement.offsetWidth:t.parentElement.offsetHeight;return parseFloat(e)/100*i}return e.includes("px")?parseFloat(e):e.includes("vw")?parseFloat(e)/100*window.innerWidth:e.includes("vh")?parseFloat(e)/100*window.innerHeight:e.includes("rem")?parseFloat(e)*parseFloat(i.fontSize):parseFloat(e)},d=a(s,"width"),l=a(r,"width"),c=a(o,"height"),u=a(h,"height"),m=e=>0===e||Number.isNaN(e),p=m(d)?-1/0:d,g=m(l)?1/0:l;return{min:{width:p,height:m(c)?-1/0:c},max:{width:g,height:m(u)?1/0:u}}}}}]);