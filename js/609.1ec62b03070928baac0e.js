"use strict";(self.webpackChunkreact_base=self.webpackChunkreact_base||[]).push([[609],{7609:(e,t,s)=>{s.r(t),s.d(t,{default:()=>p});var o=s(1527),r=s(4727),i=s(959),n=s(7327),l=s(1073),h=s(2699),a=s(2625),c=s(3418),d=s(9800),u=s(7217);const m=new class{renderer;camera;scene;container;resizeObserver;constructor(){this.renderer=new n.CP7({antialias:!0}),this.camera=new n.cPb,this.scene=new n.xsS,this.resizeObserver=new ResizeObserver((0,h.debounce)(this.resize.bind(this)))}initialized=!1;initialize(e){this.initialized=!0;const t=(0,u.sb)(e);t&&(this.container=t,this.resize(),this.container.appendChild(this.renderer.domElement),this.scene.add(this.camera),this.renderer.setAnimationLoop(this.render.bind(this)),this.resizeObserver.observe(this.container))}resize(){if(!this.container)return;const{offsetWidth:e,offsetHeight:t}=this.container;this.renderer.setSize(e,t),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}render(){this.initialized&&(this.controls&&this.controls.update(),this.renderer.render(this.scene,this.camera))}controls;addControl(){return this.controls=new c.z(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this}dispose(){this.initialized=!1,this.container&&this.container.removeChild(this.renderer.domElement),this.resizeObserver.disconnect()}};new class{loader;models;constructor(){this.loader=new d.E,this.models={},(0,a.rC)(this,{models:a.LO,updateModels:a.aD})}updateModels(e,t){this.models=Object.assign({},this.models,{[e]:t})}removeModels(e){delete this.models[e]}clearModels(){this.models={}}load(e){if(e?.length)for(let t=0;t<e.length;t++){const s=e[t];if((0,u.tr)(s,"gltf")){const e=crypto.randomUUID(),t={userData:{uuid:e,file:s,progress:0}};this.updateModels(e,t),this.loader.load(URL.createObjectURL(s),(s=>{s.userData=t.userData,this.updateModels(e,s)}),(e=>{t.userData.progress=e.loaded/e.total}))}}}};const p=(0,r.Pi)((()=>{const e=(0,i.useRef)(null),t=(0,i.useRef)(null),s=new l.uv;return(0,i.useEffect)((()=>{if(e.current){m.camera.position.set(0,10,50),m.initialize(e.current),m.addControl();const t=new n.Mig(16777215,.5);m.scene.add(t);const s=new n.Ox3(16777215,.5);m.scene.add(s);const o=new n._12(100,100),r=new n.xoR,i=new n.Kj0(o,r);i.rotation.x=-Math.PI/2,m.scene.add(i)}return t.current&&s.add(t.current,"right"),()=>{m.dispose(),s.dispose()}}),[]),(0,o.jsxs)("div",{className:"all-full flex overflow-hidden",children:[(0,o.jsx)("div",{ref:t,style:{flexShrink:0},children:"操作栏"}),(0,o.jsx)("div",{ref:e,className:"flex-1"})]})}))},1073:(e,t,s)=>{s.d(t,{uv:()=>l});var o=s(2699),r=s(7217);class i{cursor;controlElements;constructor(){this.cursor=document.body.style.cursor,this.controlElements={}}render(e){if("all"===e){const e=["top","right","bottom","left","leftTop","rightTop","rightBottom","leftBottom"];for(const t of e)this.getController(t)}else Array.isArray(e)?e.forEach((e=>{this.getController(e)})):this.getController(e)}getController(e){const t=document.createElement("div");t.classList.add("controller"),t.style.position="absolute",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center";const s=document.createElement("div");switch(s.style.transition="all 0.2s",e){case"left":case"right":t.style[e]="-10px",t.style.top="0",t.style.height="100%",t.style.width="20px",s.style.height="100%",s.style.width="4px";break;case"top":case"bottom":t.style[e]="-10px",t.style.left="0",t.style.width="100%",t.style.height="20px",s.style.width="100%",s.style.height="4px";break;case"leftTop":case"rightTop":"leftTop"===e?(t.style.left="-2px",t.style.alignItems="flex-end",t.style.justifyContent="flex-end",s.style.borderLeft="4px solid transparent"):(t.style.right="-2px",t.style.alignItems="flex-end",t.style.justifyContent="flex-start",s.style.borderRight="4px solid transparent"),t.style.top="-2px",t.style.width="20px",t.style.height="20px",s.style.width="20px",s.style.height="20px",s.style.borderTop="4px solid transparent";break;case"leftBottom":case"rightBottom":"leftBottom"===e?(t.style.left="-2px",t.style.alignItems="flex-start",t.style.justifyContent="flex-end",s.style.borderLeft="4px solid transparent"):(t.style.right="-2px",t.style.alignItems="flex-start",t.style.justifyContent="flex-start",s.style.borderRight="4px solid transparent"),t.style.bottom="-2px",t.style.width="20px",t.style.height="20px",s.style.width="20px",s.style.height="20px",s.style.borderBottom="4px solid transparent"}t.onmouseenter=()=>{document.body.style.cursor=this.getCursorForDirection(e),"left"===e||"top"===e||"right"===e||"bottom"===e?s.style.backgroundColor="blue":s.style.borderColor="blue"},t.onmouseleave=()=>{document.body.style.cursor=this.cursor,"left"===e||"top"===e||"right"===e||"bottom"===e?s.style.backgroundColor="transparent":s.style.borderColor="transparent"},t.appendChild(s),this.controlElements[e]=t}getCursorForDirection(e){switch(e){case"top":return"n-resize";case"bottom":return"s-resize";case"left":return"w-resize";case"right":return"e-resize";case"leftTop":return"nw-resize";case"rightTop":return"ne-resize";case"rightBottom":return"se-resize";case"leftBottom":return"sw-resize";default:return this.cursor}}dispose(){let e;for(e in document.body.style.cursor=this.cursor,this.controlElements)this.controlElements[e]?.remove();this.controlElements={}}}class n{el;startRect;direction;controlMap=new Map;userSelect=document.body.style.userSelect;currentDom;constructor(){this.el=null,this.startRect=null,this.start=this.start.bind(this),this.move=this.move.bind(this),this.end=this.end.bind(this)}add(e,t,s){this.el=e,this.controlMap.set(t,s);const o=e=>{this.currentDom=t,this.start(e)};t.onmousedown=o,t.ontouchstart=o}start(e){if(!this.currentDom||!this.el)return;e.preventDefault(),this.userSelect=document.body.style.userSelect,document.body.style.userSelect="none",this.direction=this.controlMap.get(this.currentDom);const{width:t,height:s,left:r,top:i}=this.el.getBoundingClientRect();this.startRect=(0,o.merge)({},this.startRect,{width:t,height:s,left:r,top:i}),e instanceof MouseEvent?((0,o.merge)(this.startRect,{x:e.pageX,y:e.pageY}),document.addEventListener("mousemove",this.move),document.addEventListener("mouseup",this.end)):((0,o.merge)(this.startRect,{x:e.touches[0].pageX,y:e.touches[0].pageY}),document.addEventListener("touchmove",this.move,{passive:!1}),document.addEventListener("touchend",this.end),document.addEventListener("touchcancel",this.end))}move(e){if(this.startRect)switch(e.preventDefault(),this.direction){case"left":this.moveLeft(e);break;case"right":this.moveRight(e);break;case"top":this.moveTop(e);break;case"bottom":this.moveBottom(e);break;case"leftTop":this.moveLeft(e),this.moveTop(e);break;case"rightTop":this.moveRight(e),this.moveTop(e);break;case"leftBottom":this.moveLeft(e),this.moveBottom(e);break;case"rightBottom":this.moveRight(e),this.moveBottom(e)}}moveLeft(e){if(!this.el||!this.startRect)return;const t=e instanceof MouseEvent?e.pageX:e.touches[0].pageX,s=this.startRect.x-t;this.el.style.width=this.startRect.width+s+"px"}moveRight(e){if(!this.el||!this.startRect)return;const t=(e instanceof MouseEvent?e.pageX:e.touches[0].pageX)-this.startRect.x;this.el.style.width=this.startRect.width+t+"px"}moveTop(e){if(!this.el||!this.startRect)return;const t=e instanceof MouseEvent?e.pageY:e.touches[0].pageY,s=this.startRect.y-t;this.el.style.height=this.startRect.height+s+"px"}moveBottom(e){if(!this.el||!this.startRect)return;const t=(e instanceof MouseEvent?e.pageY:e.touches[0].pageY)-this.startRect.y;this.el.style.height=this.startRect.height+t+"px"}end(){console.log("end"),document.body.style.userSelect=this.userSelect,this.startRect=null,document.removeEventListener("mousemove",this.move),document.removeEventListener("mouseup",this.end),document.removeEventListener("touchmove",this.move),document.removeEventListener("touchend",this.end),document.removeEventListener("touchcancel",this.end)}dispose(){this.controlMap.clear(),this.end()}}class l{controlMap=new Map;controls;resizeEvents;constructor(){this.controls=new i,this.resizeEvents=new n}add(e,t="all"){const s=(0,r.sb)(e);if(!s)throw`${e}: the element is not found`;s.style.position="relative",this.controlMap.set(s,t),this.register()}register(){[...this.controlMap.entries()].forEach((([e,t])=>{this.controls.render(t);const{controlElements:s}=this.controls;let o;for(o in s){const t=o,r=s[t];r&&(this.resizeEvents.add(e,r,t),e.appendChild(r))}}))}dispose(){this.controlMap.clear(),this.controls.dispose(),this.resizeEvents.dispose()}}},7217:(e,t,s)=>{s.d(t,{XF:()=>o,sb:()=>r,tr:()=>i});const o=(e,t)=>Math.floor(Math.random()*(t-e))+e,r=e=>"string"==typeof e?document.querySelector(e):e,i=(e,t,s)=>new RegExp(`\\.${t}$`,s).test(e.name)}}]);